---
title: "langchain"
date: 2025-08-29 16:06:05 +0900
categories: [ë¹„ì¦ˆë‹ˆìŠ¤]
tags: [Python]
toc: true
comments: false
mermaid: true
math: true
---

# **í´ëž˜ìŠ¤ ë¶ˆê· í˜•(Class Imbalance) í•´ê²°ë²•: ë°ì´í„° ê³¼í•™ìžì™€ MLOps ì—”ì§€ë‹ˆì–´ë¥¼ ìœ„í•œ ì‹¤ì „ ê°€ì´ë“œ**

> **â€œë°ì´í„°ê°€ ë§í•˜ëŠ” â€˜ë¶ˆê· í˜•â€™ì˜ ì§„ì‹¤â€**  
> *í´ëž˜ìŠ¤ ë¶ˆê· í˜•ì´ ëª¨ë¸ ì„±ëŠ¥ì„ ì–¼ë§ˆë‚˜ í”ë“¤ì–´ ë†“ëŠ”ì§€, ê·¸ë¦¬ê³  ì´ë¥¼ ì–´ë–»ê²Œ ì •ë³µí•  ìˆ˜ ìžˆëŠ”ì§€ í•œëˆˆì— íŒŒì•…í•´ ë³´ì„¸ìš”.*

---

## 1ï¸âƒ£ ì™œ í´ëž˜ìŠ¤ ë¶ˆê· í˜•ì´ ë¬¸ì œì¸ê°€?

- **ëª¨ë¸ íŽ¸í–¥**  
  ì†Œìˆ˜ í´ëž˜ìŠ¤(ì˜ˆ: í¬ê·€ ì§ˆë³‘, ì‚¬ê¸° ê±°ëž˜)ë¥¼ ë¬´ì‹œí•˜ê³  ë‹¤ìˆ˜ í´ëž˜ìŠ¤ë¡œë§Œ í•™ìŠµí•˜ë©´, **ì •í™•ë„(Accuracy)** ë§Œìœ¼ë¡œëŠ” ì„±ëŠ¥ì„ ê³¼ëŒ€í‰ê°€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

- **ë¹„ìš© ì™œê³¡**  
  ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ì—ì„œëŠ” ì†Œìˆ˜ í´ëž˜ìŠ¤ê°€ ë” í° ë¹„ìš©ì„ ì´ˆëž˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì˜ë£Œ ì§„ë‹¨ì—ì„œ ì§ˆë³‘ì„ ë†“ì¹˜ëŠ” ê²ƒì€ ì¹˜ëª…ì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

- **í‰ê°€ ì§€í‘œ ì™œê³¡**  
  Accuracy ì™¸ì—ë„ **Precision, Recall, F1â€‘Score, ROCâ€‘AUC** ê°™ì€ ì§€í‘œê°€ í•„ìš”í•©ë‹ˆë‹¤.  
  > *â€œëª¨ë“  ì˜ˆì¸¡ì„ â€˜ìŒì„±â€™ìœ¼ë¡œ í•˜ë©´ 99% ì •í™•ë„? í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” 0% Recall!â€*

---

## 2ï¸âƒ£ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ 3ê°€ì§€: ë°ì´í„°ì™€ ëª¨ë¸ì„ ê· í˜• ìžˆê²Œ ë‹¤ë£¨ëŠ” ë°©ë²•

| # | ë°©ë²• | ìž¥ì  | ë‹¨ì  | í•µì‹¬ ì¸ì‚¬ì´íŠ¸ |
|---|------|------|------|----------------|
| 1 | **ì˜¤ë²„ìƒ˜í”Œë§ (SMOTE, ADASYN)** | ì†Œìˆ˜ í´ëž˜ìŠ¤ ë°ì´í„° í™•ìž¥ â†’ ëª¨ë¸ì´ ë” ë§Žì€ íŒ¨í„´ í•™ìŠµ | ê³¼ì í•© ìœ„í—˜, ì¤‘ë³µ ë°ì´í„° ìƒì„± | *â€œìƒˆë¡œìš´ ìƒ˜í”Œì„ ë§Œë“¤ì–´ ì£¼ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê¸°ì¡´ ìƒ˜í”Œì„ â€˜ë³´ê°•â€™í•œë‹¤.â€* |
| 2 | **ì–¸ë”ìƒ˜í”Œë§ (Random, Tomek Links, ENN)** | ë‹¤ìˆ˜ í´ëž˜ìŠ¤ ë°ì´í„° ê°ì†Œ â†’ í•™ìŠµ ì†ë„ í–¥ìƒ | ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„± | *â€œê°€ìž¥ ê°€ê¹Œìš´ ì´ì›ƒì„ ì œê±°í•´ ê²½ê³„ì„  ì •ì œâ€* |
| 3 | **ë³µí•© ìƒ˜í”Œë§ (SMOTEâ€‘ENN, SMOTEâ€‘Tomek)** | ì˜¤ë²„ìƒ˜í”Œë§ + ì–¸ë”ìƒ˜í”Œë§ì˜ ìž¥ì  ê²°í•© | ë³µìž¡ì„± ì¦ê°€, ì‹¤í—˜ í•„ìš” | *â€œë‘ ê¸°ìˆ ì„ ë™ì‹œì— ì ìš©í•´ â€˜ì •ë°€í•œ ê· í˜•â€™â€* |

> **í•µì‹¬ ë©”ì‹œì§€**  
> *â€œë°ì´í„°ë¥¼ ì¡°ìž‘í•˜ëŠ” ê²ƒë³´ë‹¤, ëª¨ë¸ì´ ë¶ˆê· í˜•ì„ ì¸ì‹í•˜ë„ë¡ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.â€*

---

## 3ï¸âƒ£ ëª¨ë¸ íŠœë‹: í´ëž˜ìŠ¤ ê°€ì¤‘ì¹˜ì™€ ìž„ê³„ê°’ ì¡°ì •

| # | ì „ëžµ | ì ìš© ë°©ë²• | ê¸°ëŒ€ íš¨ê³¼ |
|---|------|-----------|-----------|
| 1 | **í´ëž˜ìŠ¤ ê°€ì¤‘ì¹˜ (Class Weight)** | ì†ì‹¤ í•¨ìˆ˜ì— ê°€ì¤‘ì¹˜ ë¶€ì—¬ | ì†Œìˆ˜ í´ëž˜ìŠ¤ì— ë” í° ì¤‘ìš”ë„ ë¶€ì—¬ |
| 2 | **ìž„ê³„ê°’ ì¡°ì • (Threshold Tuning)** | ì˜ˆì¸¡ í™•ë¥  ê¸°ì¤€ì„ ë‚®ì¶”ê±°ë‚˜ ë†’ìž„ | Precision â†” Recall ê· í˜• ì¡°ì ˆ |
| 3 | **ì ì ˆí•œ ë©”íŠ¸ë¦­ ì„ íƒ** | Accuracy â†’ Precision/Recall/F1/AUC | ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œì— ë§žëŠ” í‰ê°€ |

> **ì‹¤ì „ íŒ**  
> *â€œRandom Forest, XGBoost ë“±ì—ì„œëŠ” `class_weight='balanced'` ì˜µì…˜ì„ ë°”ë¡œ í™œìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.â€*

---

## 4ï¸âƒ£ MLOpsì™€ í´ëž˜ìŠ¤ ë¶ˆê· í˜•: ìš´ì˜ ë‹¨ê³„ì—ì„œì˜ ê´€ë¦¬

| # | ë‹¨ê³„ | í•µì‹¬ í™œë™ | ë„êµ¬/ê¸°ìˆ  |
|---|------|-----------|-----------|
| 1 | **ë°ì´í„° ìˆ˜ì§‘ & ì „ì²˜ë¦¬** | ë¶ˆê· í˜• ê°ì§€ â†’ Resampling ì ìš© | `imbalanced-learn`, `scikit-learn` |
| 2 | **ëª¨ë¸ í•™ìŠµ** | ê°€ì¤‘ì¹˜/ìž„ê³„ê°’ íŠœë‹, ì•™ìƒë¸” | `MLflow`, `Kubeflow` |
| 3 | **í‰ê°€ & ëª¨ë‹ˆí„°ë§** | ì‹¤ì‹œê°„ AUC, Drift ê°ì§€ | `Prometheus`, `Grafana` |
| 4 | **ìž¬í•™ìŠµ & ë°°í¬** | ë°ì´í„° ë“œë¦¬í”„íŠ¸ â†’ ìžë™ ìž¬í•™ìŠµ | `Argo`, `Seldon` |

> **í•µì‹¬ ë©”ì‹œì§€**  
> *â€œí´ëž˜ìŠ¤ ë¶ˆê· í˜•ì€ í•œ ë²ˆ í•´ê²°í•˜ê³  ëë‚˜ëŠ” ë¬¸ì œê°€ ì•„ë‹ˆë¼, ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ê³¼ ìž¬í•™ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.â€*

---

## 5ï¸âƒ£ ì‹¤ì „ í™œìš© ì˜ˆì‹œ: ì˜ë£Œ ì§„ë‹¨ ëª¨ë¸

1. **ë°ì´í„°**  
   - 10,000ê±´ ì¤‘ 200ê±´ì´ ì§ˆë³‘(ì†Œìˆ˜ í´ëž˜ìŠ¤)  
2. **ì „ì²˜ë¦¬**  
   - SMOTE â†’ 200 â†’ 800 (ì†Œìˆ˜ í´ëž˜ìŠ¤)  
   - SMOTEâ€‘ENN â†’ 800 ì†Œìˆ˜ + 8,000 ë‹¤ìˆ˜ â†’ 4,000 ê· í˜• ë°ì´í„°  
3. **ëª¨ë¸**  
   - XGBoost + `class_weight='balanced'`  
   - ìž„ê³„ê°’ 0.3ìœ¼ë¡œ ì¡°ì • â†’ Recall 0.85, Precision 0.70  
4. **í‰ê°€**  
   - AUC 0.92 â†’ ë†’ì€ íŒë³„ë ¥  
5. **ìš´ì˜**  
   - ë§¤ì£¼ ë°ì´í„° ë“œë¦¬í”„íŠ¸ ê°ì§€ â†’ ìžë™ ìž¬í•™ìŠµ íŠ¸ë¦¬ê±°

> **ê²°ê³¼**  
> *â€œRecallì´ 0.85ë¡œ í¬ê²Œ í–¥ìƒë˜ì—ˆê³ , ì‹¤ì œ í™˜ìž ì§„ë‹¨ì—ì„œ 15%ì˜ ë†“ì¹œ ì‚¬ë¡€ê°€ ì¤„ì—ˆìŠµë‹ˆë‹¤.â€*

---

## 6ï¸âƒ£ ë§ˆë¬´ë¦¬: í•µì‹¬ ìš”ì•½

| í•µì‹¬ í¬ì¸íŠ¸ | ì„¤ëª… |
|-------------|------|
| **ë¶ˆê· í˜• ì¸ì‹** | Accuracyë§Œìœ¼ë¡œëŠ” íŒë‹¨í•  ìˆ˜ ì—†ìœ¼ë©°, Precision/Recall/AUCê°€ í•„ìˆ˜ |
| **ë°ì´í„° ì¡°ìž‘** | SMOTE, ADASYN, Tomek Links, ENN ë“± ìƒí™©ì— ë§žê²Œ ì„ íƒ |
| **ëª¨ë¸ íŠœë‹** | í´ëž˜ìŠ¤ ê°€ì¤‘ì¹˜, ìž„ê³„ê°’ ì¡°ì •, ì ì ˆí•œ ë©”íŠ¸ë¦­ ì‚¬ìš© |
| **MLOps í†µí•©** | ë°ì´í„° ìˆ˜ì§‘ â†’ ëª¨ë¸ í•™ìŠµ â†’ ëª¨ë‹ˆí„°ë§ â†’ ìž¬í•™ìŠµ â†’ ë°°í¬ |
| **ì‹¤ì „ ì ìš©** | ì˜ë£Œ, ì‚¬ê¸° íƒì§€ ë“±ì—ì„œ ì„±ëŠ¥ì´ í¬ê²Œ í–¥ìƒ |

> **ë§ˆì§€ë§‰ í•œ ì¤„**  
> *â€œí´ëž˜ìŠ¤ ë¶ˆê· í˜•ì€ â€˜ë°ì´í„°ì˜ íŽ¸ê²¬â€™ì´ ì•„ë‹ˆë¼ â€˜ëª¨ë¸ì˜ ê¸°íšŒâ€™ìž…ë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ì „ëžµìœ¼ë¡œ ì´ ê¸°íšŒë¥¼ ìž¡ì•„ë³´ì„¸ìš”!â€*

---

### ðŸ“Œ ë…ìž ì°¸ì—¬ ì½”ë„ˆ

- **ì§ˆë¬¸**: ì—¬ëŸ¬ë¶„ì´ ë‹¤ë¤„ë³¸ ë°ì´í„°ì…‹ì—ì„œ ê°€ìž¥ í° í´ëž˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œëŠ” ë¬´ì—‡ì´ì—ˆë‚˜ìš”?  
- **ë‹µë³€**: ì•„ëž˜ ëŒ“ê¸€ì— ê³µìœ í•´ ì£¼ì„¸ìš”!  
- **ë³´ìƒ**: ê°€ìž¥ ìœ ìµí•œ ë‹µë³€ì„ ë‹¬ì•„ ì£¼ì‹  ë¶„ê»˜ëŠ” **ë¬´ë£Œ ë°ì´í„° ê³¼í•™ ì›Œí¬ìˆ ì´ˆëŒ€ê¶Œ**ì„ ë“œë¦½ë‹ˆë‹¤.

---

> **ì¶œì²˜**  
> - *imbalanced-learn ê³µì‹ ë¬¸ì„œ*  
> - *Scikitâ€‘learn, XGBoost, MLflow*  
> - *MLOps Best Practices (Kubeflow, Argo)*

---